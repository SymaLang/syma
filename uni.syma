{Universe {Program App(State({Questionnaire {KV Input Nil} {KV Name Nil} {KV Age Nil}})) {Flow {Print "Enter your name: 
"} {ReadLine}} {EffQueue} {Effects {Pending} {Inbox}}} {Rules R("EnqueueEffect/Generic", {Program pre... {EffQueue {Emit eff_} cmds...} {Effects {Pending pend...} inbox_} post...}, {Program pre... {EffQueue cmds...} {Effects {Pending pend... eff_} inbox_} post...}) R("EnqueueEffect/Print", {Program pre... {EffQueue {Print m_} rest...} post...}, {Program pre... {EffQueue {Emit {Core/Effect/PrintEff m_}} rest...} post...}) R("EnqueueEffect/ReadLine", {Program pre... {EffQueue {ReadLine} rest...} post...}, {Program pre... {EffQueue {Emit {ReadLineEff}} rest...} post...}) R("PrintEff/New", {Core/Effect/PrintEff m_}, {Print FreshId() {Message m_}}) R("ReadLineEff/New", {ReadLineEff}, {ReadLine FreshId()}) R("PrintComplete", {Program pre... {Effects pending_ {Inbox {PrintComplete id_ Success} rest...}} post...}, {Program pre... {Effects pending_ {Inbox rest...}} post...}) R("Get/Here", {Core/KV/Get tag_ key_ {tag_ before... {KV key_ v_} after...}}, v_) R("Get/Skip", {Core/KV/Get tag_ key_ {tag_ {KV k_ _} rest...}}, {Core/KV/Get tag_ key_ {tag_ rest...}}, -100) R("Put/Replace", {Core/KV/Put tag_ key_ v_ {tag_ before... {KV key_ _} after...}}, {tag_ before... {KV key_ v_} after...}) R("Put/Insert", {Core/KV/Put tag_ key_ v_ {tag_ fields...}}, {tag_ fields... {KV key_ v_}}, -100) R("SetField", {Core/KV/Set tag_ key_ v_ st_}, {Core/KV/Put tag_ key_ v_ st_}) R("Patch/End", {Core/KV/Patch tag_ st_}, st_) R("Patch/Step", {Core/KV/Patch tag_ st_ {KV k_ v_} more...}, {Core/KV/Patch tag_ {Core/KV/Put tag_ k_ v_ st_} more...}) R("ProcessFlow/StoreName", {Program pre... App(st_) {Flow {StoreName} flow...} post...}, {Program pre... App({{Patch Questionnaire st_ {KV Input Nil} {KV Name {Get Questionnaire Input st_}}}}) {Flow flow...} post...}) R("ProcessFlow/PrintName", {Program pre... App(State(a..., {Name name_}, b...)) {Flow {PrintName} flow...} post...}, {Program pre... App(State(a..., {Name name_}, b...)) {Flow {Print Concat("Hello ", name_, "!
")} flow...} post...}) R("ProcessFlow/StoreAge", {Program pre... App(State({Input age_}, rest..., {Age})) {Flow {StoreAge} flow...} post...}, {Program pre... App(State({Input}, rest..., {Age age_})) {Flow flow...} post...}) R("ProcessFlow/PrintAge", {Program pre... App(State(a..., {Age age_}, b...)) {Flow {PrintAge}} post...}, {Program pre... App(State(a..., {Age age_}, b...)) {Flow {Print Concat("You are ", age_, " years old!
")} flow...} post...}) R("Flow/StepWhenIdle", {Program pre... {Flow head_ rest...} {EffQueue} {Effects {Pending} {Inbox}} post...}, {Program pre... {Flow rest...} {EffQueue head_} {Effects {Pending} {Inbox}} post...}) R("ProcessReadLine", {Program pre... App(st_) omit... {Effects pending_ {Inbox {ReadLineComplete id_ {Text input_}} rest...}} post...}, {Program pre... App() omit... {Effects pending_ {Inbox rest...}} post...})} {RuleRules R("PlumbThroughProgram", R(n_, {Core/Plumb/Plumb acts...}, {Core/Plumb/PlumbEnd endacts...}), R(n_, {Program {/! pre...} acts... {/! post...}}, {Program {/! pre...} endacts... {/! post...}}))}}